package com.sxm.blog.admin.security;import com.sxm.blog.admin.entity.Menu;import com.sxm.blog.admin.entity.User;import lombok.extern.slf4j.Slf4j;import org.springframework.security.core.Authentication;import org.springframework.stereotype.Component;import org.springframework.util.AntPathMatcher;import javax.servlet.http.HttpServletRequest;import java.util.List;/** * RBAC数据模型控制权限 * * @author charlie */@Component("rbacPermission")@Slf4jpublic class RbacPermission {    private AntPathMatcher antPathMatcher = new AntPathMatcher();    public boolean hasPermission(HttpServletRequest request, Authentication authentication) {        Object principal = authentication.getPrincipal();        boolean hasPermission = false;        if (principal instanceof User) {            // 读取用户所拥有的权限菜单            List<Menu> menus = ((User) principal).getRoleMenus();            log.info("菜单数量:{}", menus.size());            for (Menu menu : menus) {                if (antPathMatcher.match(menu.getMenuUrl(), request.getRequestURI())) {                    hasPermission = true;                    break;                }            }        }        return hasPermission;    }}