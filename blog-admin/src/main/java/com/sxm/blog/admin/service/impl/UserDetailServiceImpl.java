package com.sxm.blog.admin.service.impl;import com.sxm.blog.admin.entity.User;import com.sxm.blog.admin.mapper.MenuMapper;import com.sxm.blog.admin.mapper.RoleMapper;import com.sxm.blog.admin.mapper.UserMapper;import lombok.extern.slf4j.Slf4j;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Service;/** * @author * @description * @date 2020/5/6 */@Service@Slf4jpublic class UserDetailServiceImpl implements UserDetailsService {    @Autowired    private UserMapper userMapper;//    @Autowired//    private MenuMapper menuMapper;////    @Autowired//    private RoleMapper roleMapper;    @Override    public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {        User user = this.userMapper.getByUserName(username);        log.info("查询用户:{}, {}", username, user);        if (user != null) {//            log.info("查询用户角色:{}", user.getId());//            List<Role> roles = this.roleMapper.getByUserId(user.getId());//            List<Menu> menus = null;//            // 填充权限//            Collection<SimpleGrantedAuthority> authorities = new HashSet<SimpleGrantedAuthority>();//            if (roles != null && roles.size() > 0) {//                for (Role role : roles) {//                    authorities.add(new SimpleGrantedAuthority(role.getRoleName()));//                }//                log.info("查询菜单:{}", roles);//                menus = this.menuMapper.getByRoleIds(roles);//            }            //return new User(username, user.getPassword(), authorities, menus);            return user;        } else {            log.error("未查询到用户:{}", username);            throw new UsernameNotFoundException("未查询到用户" + username);        }    }}